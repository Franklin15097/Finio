#!/bin/bash

# ะกะบัะธะฟั ะดะปั ะดะตะฟะปะพั ัะปัััะตะฝะธะน ะดะธะทะฐะนะฝะฐ V3
# ะะฒัะพะผะฐัะธัะตัะบะธะน ะบะพะผะผะธั ะธ ะดะตะฟะปะพะน ะฒัะตั ะธะทะผะตะฝะตะฝะธะน

set -e

echo "๐จ ะะฐัะธะฝะฐะตะผ ะดะตะฟะปะพะน ัะปัััะตะฝะธะน ะดะธะทะฐะนะฝะฐ Finio V3..."

# ะฆะฒะตัะฐ ะดะปั ะฒัะฒะพะดะฐ
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
NC='\033[0m' # No Color

# ะัะพะฒะตัะบะฐ, ััะพ ะผั ะฒ ะบะพัะฝะต ะฟัะพะตะบัะฐ
if [ ! -f "package.json" ]; then
    echo -e "${RED}โ ะัะธะฑะบะฐ: package.json ะฝะต ะฝะฐะนะดะตะฝ. ะะฐะฟัััะธัะต ัะบัะธะฟั ะธะท ะบะพัะฝั ะฟัะพะตะบัะฐ.${NC}"
    exit 1
fi

# ะัะพะฒะตัะบะฐ ะธะทะผะตะฝะตะฝะธะน
echo -e "${BLUE}๐ ะัะพะฒะตัะบะฐ ะธะทะผะตะฝะตะฝะธะน...${NC}"
if [ -z "$(git status --porcelain)" ]; then
    echo -e "${YELLOW}โ๏ธ  ะะตั ะธะทะผะตะฝะตะฝะธะน ะดะปั ะบะพะผะผะธัะฐ${NC}"
    exit 0
fi

# ะะพะบะฐะทะฐัั ะธะทะผะตะฝะตะฝะฝัะต ัะฐะนะปั
echo -e "${BLUE}๐ ะะทะผะตะฝะตะฝะฝัะต ัะฐะนะปั:${NC}"
git status --short

# ะะพะฑะฐะฒะธัั ะฒัะต ะธะทะผะตะฝะตะฝะธั
echo -e "${BLUE}โ ะะพะฑะฐะฒะปะตะฝะธะต ัะฐะนะปะพะฒ ะฒ git...${NC}"
git add .

# ะกะพะทะดะฐัั ะบะพะผะผะธั
COMMIT_MESSAGE="๐จ Design V3: ะะตะฐะปะธะทะพะฒะฐะฝั ัะพะฟ-15 ัะปัััะตะฝะธะน ะดะธะทะฐะนะฝะฐ

โจ ะะพะฒัะต ะบะพะผะฟะพะฝะตะฝัั:
- AnimatedCounter - ะฐะฝะธะผะธัะพะฒะฐะฝะฝัะน ััะตััะธะบ
- CategoryGrid - ัะตัะบะฐ ะบะฐัะตะณะพัะธะน ั ะฟัะพะณัะตััะพะผ
- ConfettiEffect - ัััะตะบั ะบะพะฝัะตััะธ
- MorphingIcon - ะผะพััะธะฝะณ ะธะบะพะฝะพะบ
- FloatingActionButton - ะฟะปะฐะฒะฐััะฐั ะบะฝะพะฟะบะฐ ะดะตะนััะฒะธะน
- GradientButton - ะบะฝะพะฟะบะฐ ั ะณัะฐะดะธะตะฝัะพะผ
- AnimatedDonutChart - ะธะฝัะตัะฐะบัะธะฒะฝะฐั ะบััะณะพะฒะฐั ะดะธะฐะณัะฐะผะผะฐ
- LiquidProgressBar - ะฟัะพะณัะตัั-ะฑะฐั ั ัััะตะบัะพะผ ะถะธะดะบะพััะธ
- SparklineWithGradient - ะผะธะฝะธ-ะณัะฐัะธะบ ั ะณัะฐะดะธะตะฝัะพะผ

๐จ ะฃะปัััะตะฝะธั:
- Glassmorphism ัััะตะบัั
- 5 ะฝะพะฒัั ัะฒะตัะพะฒัั ัะตะผ (Ocean, Sunset, Forest, Midnight, Cherry)
- ะะฐััะธัะตะฝะฝัะต ะฐะฝะธะผะฐัะธะธ (morphing, wave, heartbeat, swing)
- ะฃะปัััะตะฝะฝัะน Dashboard ั ะฝะพะฒัะผะธ ะบะพะผะฟะพะฝะตะฝัะฐะผะธ
- Particles ัะพะฝ ั ะธะฝัะตัะฐะบัะธะฒะฝะพัััั
- Hover ัััะตะบัั ั 3D ััะฐะฝััะพัะผะฐัะธัะผะธ
- Gradient borders ะธ neon glow
- Skeleton loading ั shimmer
- Stagger animations

๐ฑ ะะพะฑะธะปัะฝะฐั ะพะฟัะธะผะธะทะฐัะธั:
- Touch-friendly ะธะฝัะตััะตะนั
- Swipe gestures
- Pull to refresh
- Bottom navigation
- Haptic feedback

๐ ะะพะบัะผะตะฝัะฐัะธั:
- DESIGN_IMPROVEMENTS_V3.md - ะฟะพะปะฝะพะต ะพะฟะธัะฐะฝะธะต ัะปัััะตะฝะธะน
- ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะบะพะผะฟะพะฝะตะฝัะพะฒ
- ะัะบะพะฒะพะดััะฒะพ ะฟะพ ัะตะผะฐะผ ะธ ะฐะฝะธะผะฐัะธัะผ"

echo -e "${BLUE}๐ฌ ะกะพะทะดะฐะฝะธะต ะบะพะผะผะธัะฐ...${NC}"
git commit -m "$COMMIT_MESSAGE"

echo -e "${GREEN}โ ะะพะผะผะธั ัะพะทะดะฐะฝ ััะฟะตัะฝะพ!${NC}"

# ะัะพะฒะตัะบะฐ ะฝะฐะปะธัะธั ัะดะฐะปะตะฝะฝะพะณะพ ัะตะฟะพะทะธัะพัะธั
if git remote | grep -q "origin"; then
    echo -e "${BLUE}๐ Push ะฒ ัะดะฐะปะตะฝะฝัะน ัะตะฟะพะทะธัะพัะธะน...${NC}"
    
    # ะะพะปััะธัั ัะตะบัััั ะฒะตัะบั
    CURRENT_BRANCH=$(git branch --show-current)
    
    # Push ะธะทะผะตะฝะตะฝะธะน
    if git push origin "$CURRENT_BRANCH"; then
        echo -e "${GREEN}โ Push ะฒัะฟะพะปะฝะตะฝ ััะฟะตัะฝะพ!${NC}"
    else
        echo -e "${RED}โ ะัะธะฑะบะฐ ะฟัะธ push. ะะพะฟัะพะฑัะนัะต ะฒัััะฝัั: git push origin $CURRENT_BRANCH${NC}"
        exit 1
    fi
else
    echo -e "${YELLOW}โ๏ธ  ะฃะดะฐะปะตะฝะฝัะน ัะตะฟะพะทะธัะพัะธะน ะฝะต ะฝะฐัััะพะตะฝ. ะัะพะฟััะบะฐะตะผ push.${NC}"
fi

# ะกะฑะพัะบะฐ ััะพะฝัะตะฝะดะฐ
echo -e "${BLUE}๐จ ะกะฑะพัะบะฐ ััะพะฝัะตะฝะดะฐ...${NC}"
cd frontend

# ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน ะตัะปะธ ะฝัะถะฝะพ
if [ ! -d "node_modules" ]; then
    echo -e "${BLUE}๐ฆ ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน...${NC}"
    npm install
fi

# ะกะฑะพัะบะฐ
echo -e "${BLUE}๐๏ธ  ะะฐะฟััะบ ัะฑะพัะบะธ...${NC}"
if npm run build; then
    echo -e "${GREEN}โ ะกะฑะพัะบะฐ ััะพะฝัะตะฝะดะฐ ะทะฐะฒะตััะตะฝะฐ!${NC}"
else
    echo -e "${RED}โ ะัะธะฑะบะฐ ะฟัะธ ัะฑะพัะบะต ััะพะฝัะตะฝะดะฐ${NC}"
    exit 1
fi

cd ..

# ะะตัะตะทะฐะฟััะบ ัะตัะฒะธัะพะฒ
echo -e "${BLUE}๐ ะะตัะตะทะฐะฟััะบ ัะตัะฒะธัะพะฒ...${NC}"

# ะัะพะฒะตัะบะฐ ะฝะฐะปะธัะธั PM2
if command -v pm2 &> /dev/null; then
    echo -e "${BLUE}๐ ะะตัะตะทะฐะฟััะบ ัะตัะตะท PM2...${NC}"
    pm2 restart all
    echo -e "${GREEN}โ ะกะตัะฒะธัั ะฟะตัะตะทะฐะฟััะตะฝั!${NC}"
elif [ -f "docker-compose.yml" ]; then
    echo -e "${BLUE}๐ณ ะะตัะตะทะฐะฟััะบ ัะตัะตะท Docker Compose...${NC}"
    docker-compose restart
    echo -e "${GREEN}โ ะะพะฝัะตะนะฝะตัั ะฟะตัะตะทะฐะฟััะตะฝั!${NC}"
else
    echo -e "${YELLOW}โ๏ธ  PM2 ะธ Docker ะฝะต ะฝะฐะนะดะตะฝั. ะะตัะตะทะฐะฟัััะธัะต ัะตัะฒะธัั ะฒัััะฝัั.${NC}"
fi

# ะคะธะฝะฐะปัะฝะพะต ัะพะพะฑัะตะฝะธะต
echo ""
echo -e "${GREEN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${GREEN}โ                                                        โ${NC}"
echo -e "${GREEN}โ  ๐ ะะตะฟะปะพะน ัะปัััะตะฝะธะน ะดะธะทะฐะนะฝะฐ V3 ะทะฐะฒะตััะตะฝ ััะฟะตัะฝะพ!     โ${NC}"
echo -e "${GREEN}โ                                                        โ${NC}"
echo -e "${GREEN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo -e "${BLUE}๐ ะกัะฐัะธััะธะบะฐ:${NC}"
echo -e "  โข ะะพะฒัั ะบะพะผะฟะพะฝะตะฝัะพะฒ: ${GREEN}9${NC}"
echo -e "  โข ะะพะฒัั ะฐะฝะธะผะฐัะธะน: ${GREEN}15+${NC}"
echo -e "  โข ะฆะฒะตัะพะฒัั ัะตะผ: ${GREEN}5${NC}"
echo -e "  โข ะฃะปัััะตะฝะธะน: ${GREEN}15${NC}"
echo ""
echo -e "${BLUE}๐ ะะพะบัะผะตะฝัะฐัะธั:${NC}"
echo -e "  โข docs/DESIGN_IMPROVEMENTS_V3.md"
echo ""
echo -e "${BLUE}๐ ะัะพะฒะตัััะต ะฟัะธะปะพะถะตะฝะธะต:${NC}"
echo -e "  โข Frontend: ${GREEN}http://localhost:5173${NC}"
echo -e "  โข Backend: ${GREEN}http://localhost:3000${NC}"
echo ""
echo -e "${YELLOW}๐ก ะกะพะฒะตั: ะะพะฟัะพะฑัะนัะต ัะฐะทะฝัะต ัะตะผั ะฒ ะฝะฐัััะพะนะบะฐั!${NC}"
echo ""
